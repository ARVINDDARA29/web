<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Friendly AI Chat</title>
<style>
  body { font-family: Arial; background: #f5f5f5; margin:0; padding:0; display:flex; flex-direction:column; height:100vh;}
  #chatBox { flex:1; overflow-y:auto; padding:10px; max-width:700px; margin:0 auto; display:flex; flex-direction:column; }
  .message { margin:5px 0; padding:10px; border-radius:10px; max-width:80%; word-break:break-word; }
  .user { background:#d1e7ff; align-self:flex-end; text-align:right;}
  .ai { background:#e2ffe2; align-self:flex-start; text-align:left;}
  #inputArea { display:flex; padding:10px; max-width:700px; margin:0 auto; }
  #inputText { flex:1; padding:10px; border-radius:5px 0 0 5px; border:1px solid #ccc; outline:none; }
  #sendBtn { padding:10px 20px; border:none; border-radius:0 5px 5px 0; background:#4CAF50; color:white; cursor:pointer; }
  #sendBtn:hover { background:#45a049; }
  .loader { font-style:italic; color:#888; }
  img.ai-img { max-width:200px; margin-top:5px; border-radius:5px; cursor:pointer; }
</style>
</head>
<body>

<div id="chatBox"></div>

<div id="inputArea">
  <input type="text" id="inputText" placeholder="Type your message..." />
  <button id="sendBtn">Send</button>
</div>

<script>
const apiKey = "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";
const model = "x-ai/grok-4-fast:free";
const chatBox = document.getElementById("chatBox");
const inputText = document.getElementById("inputText");
const sendBtn = document.getElementById("sendBtn");

// Default AI message
appendMessage("Hello! मैं आपका मज़ाकिया AI हूँ 😎. मुझसे कुछ भी पूछ सकते हो!", "ai");

sendBtn.addEventListener("click", sendMessage);
inputText.addEventListener("keypress", function(e){ if(e.key==="Enter"){sendMessage();} });

async function sendMessage() {
  const message = inputText.value.trim();
  if(!message) return;
  appendMessage(message, "user");
  inputText.value = "";

  // Loader
  const loaderDiv = appendMessage("Typing...", "ai", true);

  try {
    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${apiKey}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: model,
        messages: [
          {
            role: "system",
            content: "You are a friendly, funny AI. Always reply in a playful, humorous tone. Be friendly and a bit cheeky. If user asks 'Who created you?', reply 'Arvind Bishnoi ने बनाया, और मैं उसके jokes भी याद रखता हूँ 😎'."
          },
          {
            role: "user",
            content: message
          }
        ]
      })
    });
    
    const data = await response.json();
    loaderDiv.textContent = ""; 
    loaderDiv.classList.remove("loader");

    // AI response text
    const aiText = data.choices?.[0]?.message?.content;
    if(aiText) appendMessage(aiText, "ai");

    // Check if AI returned images
    const images = data.choices?.[0]?.message?.images || [];
    images.forEach(url => {
      const img = document.createElement("img");
      img.src = url;
      img.classList.add("ai-img");
      img.onclick = () => window.open(url,"_blank"); // click to open full image
      loaderDiv.appendChild(img);
    });

    if(!aiText && images.length===0) loaderDiv.textContent = "No response from AI.";
  } catch(err) {
    console.error(err);
    loaderDiv.textContent = "Error connecting to API.";
    loaderDiv.classList.remove("loader");
  }
}

function appendMessage(text, sender, isLoader=false) {
  const div = document.createElement("div");
  div.classList.add("message", sender);
  if(isLoader) div.classList.add("loader");
  div.textContent = text;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
  return div;
}
</script>

</body>
</html>
